#!/bin/sh
#
# This is a direct wrapper around `emacsclient` that can be used as a value for
# $EDITOR. By default it's blocking; to invoke asynchronously, pass -n as shown
# in the docs for `emacsclient`.
set -o errexit -o nounset

if [ $# -lt 1 ]; then
    echo "Usage: $(basename "$0") <file>" >&2
    exit 1
fi

# Load magit as-needed to avoid invoking global git commit mode in the Emacs
# init file and speed up initial launch times.
emacsclient --eval "(global-git-commit-mode t)" --quiet >/dev/null 2>&1 || true

emacsclient --alternate-editor=emacs --quiet "$@" 2>/dev/null
