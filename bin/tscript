#!/usr/bin/env bash

mapfile -t arr < <(fd -e txt "\\.IFA534_[0-9]+\\.")

for i in "${arr[@]}"; do
    preroot="${i//*validation\/}"
    root="$(echo "${preroot}" | cut -d "/" -f1)"
    subroot="$(basename "$(dirname "${i}")")"
    if [[ $root == "IFA_534" ]]; then
        repl="${root}_${subroot}"
    else
        repl="${root}"
    fi
    realrep="$(echo "${i}" | sed -E 's/IFA534_[0-9]+/'"${repl}"'/g')"
    mv -v "${i}" "${realrep}"
done
