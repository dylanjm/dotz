#!/usr/bin/env zsh

nuke() {
    declare -i dry_run
    while getopts ":n" flag; do
        case "${flag}" in
            n) dry_run=1
               ;;
            *) exit 1
               ;;
        esac
    done

    if [[ "${dry_run:-0}" == 1 ]]; then
        git clean -dfxn \
            && git submodule foreach --recursive git clean -dfxn
    else
        read -r "response?Are you sure? [y/N] "
        if [[ "${response}" =~ ^([yY][eE][sS]|[yY])+$ ]]; then
            git clean -dfx \
                && git submodule foreach --recursive git clean -dfx
        else
            return 0
        fi
    fi
}
